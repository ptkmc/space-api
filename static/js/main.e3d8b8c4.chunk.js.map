{"version":3,"sources":["components/OpenLayersMap.js","components/AstronautAvatar.js","components/AstronautInfo.js","components/StationInfo.js","components/App.js","index.js"],"names":["OpenLayersMap","state","map","receiving","curLineLayer","coords","this","getLayers","item","getSource","getFeatures","getGeometry","setCoordinates","appendCoordinate","feature","Feature","geometry","Point","name","pointStyle","Style","image","CircleStyle","radius","fill","Fill","color","zIndex","source","VectorSource","features","vector","VectorLayer","style","addLayer","lineString","LineString","transform","lineStyle","stroke","Stroke","width","lineCoords","flatCoordinates","wrapXMax","length","wrapXMin","wrapYMax","wrapYMin","fromLonLat","props","hasWrapped","addLine","setState","updatePoint","updateLine","addPoint","getView","setCenter","Map","target","layers","TileLayer","OSM","view","View","center","zoom","controls","id","className","React","Component","AstronautAvatar","src","alt","person","AstronautInfo","num","people","Object","values","astronauts","crafts","i","craft","craftArr","keys","result","numInCraft","pluralizer","nextProps","avatars","key","number","getCrafts","StationInfo","timestamp","coordStr","Date","parseInt","toLocaleTimeString","App","getAstronauts","a","axios","get","data","undefined","getLocation","res","iss_position","latitude","longitude","parseFloat","setInterval","href","title","rel","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.e3d8b8c4.chunk.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport Map from 'ol/Map';\nimport View from 'ol/View';\nimport { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer';\nimport { OSM, Vector as VectorSource } from 'ol/source';\nimport { fromLonLat } from 'ol/proj';\nimport { LineString, Point } from 'ol/geom';\nimport { Circle as CircleStyle, Fill, Stroke, Style } from 'ol/style';\nimport Feature from 'ol/Feature';\n\nclass OpenLayersMap extends React.Component {\n  state = {\n    map: {},\n    receiving: false,\n    curLineLayer: 2\n  };\n\n  updatePoint(coords) {\n    const mapLayers = this.state.map.getLayers();\n    const pointLayer = mapLayers.item(1);\n    const point = pointLayer\n      .getSource()\n      .getFeatures()[0]\n      .getGeometry();\n    point.setCoordinates(coords);\n  }\n\n  updateLine(coords, curLineLayer) {\n    const mapLayers = this.state.map.getLayers();\n    const lineLayer = mapLayers.item(curLineLayer);\n    const lineString = lineLayer\n      .getSource()\n      .getFeatures()[0]\n      .getGeometry();\n    lineString.appendCoordinate(coords);\n  }\n\n  addPoint(coords) {\n    const feature = new Feature({\n      geometry: new Point(coords),\n      name: 'Point'\n    });\n    const pointStyle = new Style({\n      image: new CircleStyle({\n        radius: 5,\n        fill: new Fill({ color: 'rgb(116, 68, 172)' })\n      }),\n      zIndex: 3\n    });\n    const source = new VectorSource({\n      features: [feature]\n    });\n    const vector = new VectorLayer({\n      source: source,\n      style: [pointStyle],\n      zIndex: 3\n    });\n\n    this.state.map.addLayer(vector);\n  }\n\n  addLine(coords) {\n    const lineString = new LineString(coords);\n    lineString.transform('EPSG:4326', 'EPSG:3857');\n\n    const feature = new Feature({\n      geometry: lineString,\n      name: 'Line'\n    });\n    const lineStyle = new Style({\n      stroke: new Stroke({\n        color: 'rgb(116, 68, 172, .33)',\n        width: 10\n      }),\n      zIndex: 2\n    });\n    const source = new VectorSource({\n      features: [feature]\n    });\n    const vector = new VectorLayer({\n      source: source,\n      style: [lineStyle],\n      zIndex: 2\n    });\n\n    this.state.map.addLayer(vector);\n  }\n\n  hasWrapped(coords, curLineLayer) {\n    // If the current coordinate jumps more than half-way accross the map\n    // from the previous coordinate this will be considered a wrap\n    const mapLayers = this.state.map.getLayers();\n    const lineLayer = mapLayers.item(curLineLayer);\n    const lineString = lineLayer\n      .getSource()\n      .getFeatures()[0]\n      .getGeometry();\n    const lineCoords = lineString.flatCoordinates;\n\n    const wrapXMax =\n      lineCoords[lineCoords.length - 2] > 9000000 && coords[0] < -9000000;\n    const wrapXMin =\n      lineCoords[lineCoords.length - 2] < -9000000 && coords[0] > 9000000;\n    const wrapYMax =\n      lineCoords[lineCoords.length - 1] > 4500000 && coords[1] < -4500000;\n    const wrapYMin =\n      lineCoords[lineCoords.length - 1] < -4500000 && coords[1] > 4500000;\n\n    if (wrapXMax || wrapXMin || wrapYMax || wrapYMin) {\n      return true;\n    }\n    return false;\n  }\n\n  componentDidUpdate() {\n    const coords = fromLonLat(this.props.coords);\n    let curLineLayer = this.state.curLineLayer;\n\n    if (coords[0] && coords[1]) {\n      if (!this.state.receiving) {\n        this.addPoint(coords);\n        this.addLine([]);\n        this.setState({ receiving: true });\n        this.state.map.getView().setCenter(coords);\n      } else {\n        if (this.hasWrapped(coords, curLineLayer)) {\n          this.addLine([]);\n          curLineLayer += 1;\n          this.setState({ curLineLayer: curLineLayer });\n        }\n        this.updatePoint(coords);\n        this.updateLine(coords, curLineLayer);\n      }\n    }\n  }\n\n  componentDidMount() {\n    const map = new Map({\n      target: 'map',\n      layers: [\n        new TileLayer({\n          source: new OSM({})\n        })\n      ],\n      view: new View({\n        center: fromLonLat([0, 0]),\n        zoom: 2\n      }),\n      controls: []\n    });\n\n    this.setState({ map: map });\n  }\n\n  render() {\n    return <div id=\"map\" className=\"map\" />;\n  }\n}\n\nOpenLayersMap.propTypes = {\n  coords: PropTypes.arrayOf(PropTypes.number)\n};\n\nexport default OpenLayersMap;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass AstronautAvatar extends React.Component {\n  render() {\n    return (\n      <div className=\"astronaut\">\n        <img\n          className=\"ui avatar image\"\n          src=\"astronaut-avatar.svg\"\n          alt=\"astronaut avatar\"\n        />\n        <span>{this.props.person.name}</span>\n      </div>\n    );\n  }\n}\n\nAstronautAvatar.propTypes = {\n  person: PropTypes.objectOf(PropTypes.string)\n};\n\nexport default AstronautAvatar;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport AstronautAvatar from './AstronautAvatar';\n\nclass AstronautInfo extends React.Component {\n  pluralizer(num) {\n    return num === 1 ? 'is' : 'are';\n  }\n\n  getCrafts() {\n    const people = Object.values(this.props.astronauts.people);\n    const crafts = {};\n\n    for (let i = 0; i < people.length; i++) {\n      let craft = people[i].craft;\n      crafts[craft] = crafts[craft] ? crafts[craft] + 1 : 1;\n    }\n\n    const craftArr = Object.keys(crafts);\n\n    if (craftArr.length === 0) {\n      return '.';\n    }\n    if (craftArr.length === 1) {\n      return ` and all of them are aboard the ${craftArr[0]}.`;\n    } else {\n      let result = '';\n      for (let i = 0; i < craftArr.length; i++) {\n        let numInCraft = crafts[craftArr[i]];\n        if (i === 0) {\n          result += `. ${numInCraft} ${this.pluralizer(\n            numInCraft\n          )} aboard the ${craftArr[i]}`;\n        } else if (i !== craftArr.length - 1) {\n          result += `, ${numInCraft} ${this.pluralizer(\n            numInCraft\n          )} aboard the ${craftArr[i]}`;\n        } else {\n          result += `, and ${numInCraft} ${this.pluralizer(\n            numInCraft\n          )} aboard the ${craftArr[i]}.`;\n        }\n      }\n      return result;\n    }\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.astronauts !== nextProps.astronauts;\n  }\n\n  render() {\n    if (this.props.astronauts === null) {\n      return (\n        <div>\n          <h1>Astronauts in Space</h1>\n          <p></p>\n          <ul className=\"astronauts\"></ul>\n        </div>\n      );\n    }\n\n    if (this.props.astronauts) {\n      const avatars = this.props.astronauts.people.map(person => (\n        <AstronautAvatar person={person} key={person.name} />\n      ));\n\n      return (\n        <div>\n          <h1>Astronauts in Space</h1>\n          <p>\n            There are currently <strong>{this.props.astronauts.number}</strong>{' '}\n            astronauts in space{this.getCrafts()}\n          </p>\n          <ul className=\"astronauts\">{avatars}</ul>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <h1>Astronauts in Space</h1>\n          <p className=\"astronauts\">\n            <i className=\"exclamation triangle icon\" />\n            Unable to get current astronauts.\n          </p>\n        </div>\n      );\n    }\n  }\n}\n\nAstronautInfo.propTypes = {\n  astronauts: PropTypes.object\n};\n\nexport default AstronautInfo;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nclass StationInfo extends React.Component {\n  render() {\n    if (this.props.coords === [] || this.props.timestamp === null) {\n      return (\n        <div>\n          <h1>Current Location of the ISS</h1>\n          <div className=\"location-info\">\n            <p></p>\n          </div>\n        </div>\n      );\n    }\n\n    if (this.props.coords !== [] && this.props.timestamp) {\n      const coordStr = `${this.props.coords[1]}, ${this.props.coords[0]}`;\n      const timestamp = new Date(\n        parseInt(this.props.timestamp + '000')\n      ).toLocaleTimeString();\n\n      return (\n        <div>\n          <h1>Current Location of the ISS</h1>\n          <div className=\"location-info\">\n            <p className=\"coords\">{coordStr}</p>\n            <p>{timestamp}</p>\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div>\n          <h1>Current Location of the ISS</h1>\n          <div className=\"location-info\">\n            <p>\n              <i className=\"exclamation triangle icon\" />\n              Unable to get current location. Retrying in 5 seconds...\n            </p>\n          </div>\n        </div>\n      );\n    }\n  }\n}\n\nStationInfo.propTypes = {\n  coords: PropTypes.arrayOf(PropTypes.number),\n  timestamp: PropTypes.number\n};\n\nexport default StationInfo;\n","import React from 'react';\nimport axios from 'axios';\nimport OpenLayersMap from './OpenLayersMap';\nimport AstronautInfo from './AstronautInfo';\nimport StationInfo from './StationInfo';\n\nclass App extends React.Component {\n  state = {\n    coords: [],\n    timestamp: null,\n    astronauts: null\n  };\n\n  getAstronauts = async () => {\n    const url = 'https://space-api-server.herokuapp.com/api/astros.json';\n    try {\n      const data = await axios.get(url);\n      this.setState({ astronauts: data.data });\n    } catch (err) {\n      this.setState({ astronauts: undefined });\n    }\n  };\n\n  getLocation = async () => {\n    const url = 'https://space-api-server.herokuapp.com/api/iss-now.json';\n    try {\n      let res = await axios.get(url);\n      const { latitude, longitude } = res.data.iss_position;\n      const timestamp = res.data.timestamp;\n      const coords = [parseFloat(longitude), parseFloat(latitude)];\n      this.setState({\n        coords: coords,\n        timestamp: timestamp\n      });\n    } catch (err) {\n      this.setState({\n        coords: [],\n        timestamp: undefined\n      });\n    }\n  };\n\n  componentDidMount() {\n    this.getAstronauts();\n    setInterval(() => {\n      this.getAstronauts();\n    }, 300000);\n\n    this.getLocation();\n    setInterval(() => {\n      this.getLocation();\n    }, 5000);\n  }\n\n  render() {\n    return (\n      <div className=\"ui container main\">\n        <AstronautInfo astronauts={this.state.astronauts} />\n        <StationInfo\n          coords={this.state.coords}\n          timestamp={this.state.timestamp}\n        />\n        <OpenLayersMap coords={this.state.coords} />\n        <p className=\"attribution\">\n          Data provided courtesy of{' '}\n          <a href=\"http://open-notify.org/Open-Notify-API/ISS-Location-Now/\">\n            Open Notify.\n          </a>{' '}\n          Icons by{' '}\n          <a href=\"https://www.flaticon.com/authors/srip\" title=\"srip\">\n            srip\n          </a>{' '}\n          under{' '}\n          <a\n            href=\"http://creativecommons.org/licenses/by/3.0/\"\n            title=\"Creative Commons BY 3.0\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            CC 3.0 BY.\n          </a>\n        </p>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.querySelector('#root'));\n"],"sourceRoot":""}